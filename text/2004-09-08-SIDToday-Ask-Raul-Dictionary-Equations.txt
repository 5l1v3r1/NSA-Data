<p data-reactid=".ti.1.0.0.1.0.1.$0.0" class="SidTodayFilesDetailViewer-pages-page-paragraph">DYNAMIC PAGE -- HIGHEST POSSIBLE CLASSIFICATION IS<br>TOP SECRET // SI / TK // REL TO USA AUS CAN GBR NZL<br><br>(U) Ask Raul: Dictionary Equations<br>FROM: 'Raul', a DNI Analyst<br>Unknown<br>Run Date: 09/08/2004<br><br>Dear Raul,<br>(S) Why is it that my dictionary category hauls back such a huge<br>mess? I've tried everything I can think of and all that I have is a<br>disaster. What gives?<br>-- Bob<br>Bob,<br>(S) You know, there is probably no better place than in the DNI<br>world where the old saying "Physician, heal thyself" is more true.<br>Old Raul has been around the block a few times and the vast<br>majority of the pain and suffering in the DNI world is self-inflicted.<br>(S) Let's look at a sample of one of the ingenious ways we analysts<br>go about tasking things in the dictionaries. Here it is:<br>( 'AEROSOL' AND 'GENERAT' )<br>Now, looking at this and knowing which category it came from, the<br>analyst was attempting to get things like: aerosol generator ...<br>aerosol generation ... generation of aerosols, etc.<br>Unfortunately, the analyst forgot about or didn't consider a few key<br>issues, such as:<br>1.  (S) Dictionaries look for the search terms as simple<br>patterns. So, 'GENERAT' would hit on:<br>GENERATE <br>GENERATES <br>GENERATED <br>GENERATING <br>GENERATOR <br>GENERATION <br>GENERATE <br>GENERATES <br>GENERATOR <br>REGENERATE <br>REGENERATES <br>REGENERATED <br>REGENERATING <br>REGENERATOR <br>REGENERATION <br>REGENERATE <br>REGENERATES <br>REGENERATOR, etc.<br>Did the analyst take this into account? Apparently not. This<br>happens all the time and creates a lot of problems. An easy<br><br> SERIES: <br>(U) Ask Raul - Answers<br>to DNI Questions<br>1.  Ask Raul : Fonts and<br>Encoding<br>2.  Ask Raul : Dictionary<br>Equations<br>3.  Ask Raul : HTML<br>Coding and Email<br>4.  Ask Raul : PDF Files<br>5.  Ask Raul: Damaged<br>Data<br>6.  Ask Raul : Getting<br>the Most from<br>Metadata<br><br> </p><p data-reactid=".ti.1.0.0.1.0.1.$1.0" class="SidTodayFilesDetailViewer-pages-page-paragraph">way out, in this case, would have been to include<br>whitespace, such as:<br>' GENERAT'<br>'\0x0aGENERAT'<br>It doesn't solve the whole problem but it knocks a lot of<br>stuff out instantly.<br>2.  (S) Logical statements have to be logical. Seems rather<br>apparent, but quite often what an analyst puts into the<br>dictionaries makes no real sense, logically. Using this<br>example again, the 'AND' means this equation will produce<br>hits if the pattern 'AEROSOL' appears anywhere and the<br>pattern 'GENERAT' appears anywhere. So, I could have this<br>in traffic: "aerosol generation unit for use by terrorists to kill<br>Americans" ... or ... "aerosol spray hair conditioner" ...<br>(many, many Kbytes before or after) ... the song, "Talkin'<br>'Bout My Generation" ...<br>This equation would result in both of these items being<br>returned by the category. Likewise, using an equation like:<br>'AEROSOL' WITHIN 'GENERAT'<br>...is hardly any better. If what I wanted was to get anything<br>which contains 'AEROSOL' followed by the pattern<br>'GENERAT' anywhere after 'AEROSOL' then this is the way<br>to go. Generally speaking, this is not what most folks want.<br>They want, for example, 'AEROSOL' fairly close to<br>'GENERAT' not 'AEROSOL' at the beginning of the session<br>and 'GENERAT' thousands or millions of bytes away.<br>However, using a WITHIN with a number would be much<br>better. For example:<br>'AEROSOL' WITHIN 12 'GENERAT'<br>This allows for a good bit of slop between the two terms but<br>at least puts them in close proximity to each other. If<br>combined with the above suggestion from item 1, things will<br>be even better. If I do this, I have a reasonable chance of<br>getting the sessions actually mentioning "aerosol<br>generators" and such, as opposed to sessions about<br>anything under the sun containing those two patterns like a<br>web page made by "Microsoft HTML GENERATor" with an ad<br>for an "AEROSOL hairspray".<br>3.  (S) In virtually all cases, the scan_as tables for the<br>dictionaries are set up to be case insensitive. So, things like<br>the following would produce valid hits on the term<br>'GENERAT' :<br>GENERATE <br>generate <br>Generate <br>GeNeRaTe <br>GENerAte <br>genERaTe <br>etc.<br>Can you find the term 'GENERAT' in the lines below?<br>Recognize them as base64?<br><br> </p><p data-reactid=".ti.1.0.0.1.0.1.$2.0" class="SidTodayFilesDetailViewer-pages-page-paragraph">XrYGKI4MIGr/bvBEkBppxPQWwnZKgeNerAT6ucgCFYWEAEZ<br>bcHIEBB1Tej0ktCDTODHcJZ6ditwBTsKziwxMDCDY0jD7O/B0<br>jYCjXmp1uzN4fRCzT3CD6DEQwoTJ+BJ0Lg4kGENerATS0fs5<br>OHNDDvIdOneQegenERATzrw72LwRMICtlgSBVS6TPUhEYOO<br>cjU1I8IGXps1GMPhFdGqzlouLkQXfkm39YE65L8EjHrdRxLdkZ<br>9AfttAPc2hsqaW6hkzgnn5ABDB7MxuYUoGENeRaTlw0iW86x<br>tmS4dLJHJA3nQkBPgQclbwjke3fZjl/0IoBiEQV4PDQgy+Pgen<br>eRATudCR8NTrktDGRAVSsiAnW97A0Ct9a3Dbjr48u<br>(S)This too has to be considered especially if your traffic is<br>being collected by a system which cannot handle encoding<br>and which does not process it prior to the selection and<br>filtering process.<br>4.  (S) In many, many cases the analyst throws in a very<br>generic term then, when it becomes obvious there is too<br>much junk, begins defeating things instead of positively<br>selecting on what he wants. This little area is quite<br>interesting. A typical example old Raul has seen over and<br>over goes like this -- an analyst puts a selector into a<br>category such as:<br>'ABDULBADGUY@HOTMAIL'<br>(S) Well, in short order the analyst is crying over his traffic<br>because it is basically a mountain of spam and other<br>worthless stuff. So, does the analyst do some analysis and<br>then try to include terms to get what he wants? Absolutely<br>not! He looks at a handful of items and notices there are<br>several press items. So, he sticks 'PRESS' into a defeat and<br>thinks everything is swell. The problem is, he doesn't realize<br>'PRESS' will defeat: IMPRESS, REPRESS, SUPPRESS or<br>"PRESS THE BUTTON TO ACTIVATE THE BOMB", etc.<br>(S) Next thing you know the analyst has a defeat section<br>which is larger than everything else in the category, and a<br>few minutes of review -- much to the surprise and horror of<br>the analyst -- shows that those defeat terms are defeating<br>him right out of the very traffic he wants.<br>(S) So, instead of going ape with defeats, look at your<br>traffic and go after what you want. If you don't know what<br>ICMP is, don't defeat it out of your category, use positive<br>selectors to go after the traffic type you want. Only<br>interested in ports 25 and 110? Well, include them in your<br>equations to make sure that is what you get. Think<br>positive!<br>(S) There you have it. Yes, the system is not perfect, I've skimmed<br>over these topics and there is much, much more to be discussed<br>but heck, given the way we analysts are doing things, even a<br>perfect system wouldn't work. The next time you find yourself<br>crying over the big DNI mess you have, look in the mirror first.<br>You'll be looking at the person most responsible for it.<br>Raul<br><br>"(U//FOUO) SIDtoday articles may not be republished or reposted outside NSANet<br>without the consent of S0121 (DL sid_comms)."<br><br> </p><p data-reactid=".ti.1.0.0.1.0.1.$3.0" class="SidTodayFilesDetailViewer-pages-page-paragraph">DYNAMIC PAGE -- HIGHEST POSSIBLE CLASSIFICATION IS<br>TOP SECRET // SI / TK // REL TO USA AUS CAN GBR NZL<br>DERIVED FROM: NSA/CSSM 1-52, DATED 08 JAN 2007 DECLASSIFY ON: 20320108<br><br> </p>