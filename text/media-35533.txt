LONG HAUL - Wikilnfo

The accredited security level of this system is: TOP SECRETHSI-GAMMAITALENT KEYHOLEHORCONIPROPIN
IRELIDOIREL TO USA, FVEY 
TOP SECRETHSIHREL TO USA, FVEY

(U) LONGHAUL

From Wikilnfo

The LONGHAUL system provides the Extended NSA Enterprise with an
end-to?end attack orchestration and key recovery service for Data Network Cipher (DNC) and
Data Network Session Cipher (DNSC) traf?c. LONGHAUL is extensible to allow for the addition of
other Digital Network Intelligence cipher types.

Contents

I 1 LONGHAUL Overview
I 1.1 (U) General
I 1.1.1 (U) DataFlow and CONOP
1.2 Attack Orchestration
I 1.2.1 POISONNUT
I 1.2.2 SCARLETFEVER
1.3 (U) Management and Analysis
1.4 (U) Security and Policy
1.5 (U) Common
1.6 (U) Interfaces (ICD)
I 2 (U) Design
I 2.1 (U) Architecture
I 2.2 (U) High Availability
I 2.3 (U) JMS Messaging
I 3 (U) Deployment
I 3.1 (U) Hardware
I 3.2 (U) Software Releases
I 4 (U) Development
I 4.1 (U) Software/Schedules
I 4.2 (U) Development Principles, Processes, and Standards
I 4.2.1 LONGHAUL Processes
I 4.2.1.1 (U) Requirements
I 4.2.1.2 (U) Coding Standards/Reviews
I 4.2.1.3 (U) Lessons Learned
I 4.2.1.4 (U) Con?guration Management (and Metrics)
I 4.2.1.5 (U) Testing
I 4.2.1.6 (U) Working with NSA Way
I 4.3 (U) Development and Management Tools
5 (U) Technology
I 5.1 (U) In-Memory Distributed Data Analysis of Alternatives (AOA)
I 5.2 (U) BigData and Metrics Techniques
6 (U) TE6 Security, Compliance and Policy Enforcement
7 (U) TS Certi?cation Accreditation
8 (U) Operations
I 8.1 (U) Tier 1 Support
I 8.2 (U) Tier 2 Support
I 8.3 (U) Tier 3 Support
I 8.4 (U) Site Deployments
9 (U) Transition
I 10 Team Members
1 1 (U) See also

10f15

LONGHAUL - WikiInfo

LONGHAUL Overview
(U) General

(U) DataFlow and CONOP

The LONGHAUL system is composed of several components as shown in this
End-to-End View. LONGHAUL receives information (CA Data) from the ?eld systems
and passes information back to ?eld systems using its Front End. The Front End validates the
sender/receiver using CASPORT services. LONGHAUL contains Attack Orchestration
components (one orchestrator for each distinct type of attack), and Attack Service components.
Attack orchestration ?gures out what processing should be applied for each piece of
CA Data, and then initiates, and as needed manages, that processing. Attack service performs the
attack. Once the processing is complete, the result is returned to the attack
orchestration component, information about the processing is "saved" for Management and
Analysis, and then as appropriate the result is returned to the "requesting" CA Server.
LONGHAUL accesses CES Databases for certain information needed for attack orchestration and
attack services. LONGHAUL also provides an interface for CES that need access to
information pertaining to the LONGHAUL processed data. LONGHAUL maintains its own internal
databases for the management and control of its processing activities.

    LONGHAUL Architecture mam

 

 

 

 

 

 

 

 

 

 

 

 

  
  

 

CA Rmurtu

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

 

Thus anagram has been fat readabuhty 
sites are deployed and all connechons mm are siwwn
going [0 ONE 5318 r93")? 90 [0 Wm .t-mauil 1 RH rm mm u: ."1?I4llu

LONGHAUL End-to?End Overview

LONGHAUL (in Purge_Surge parlance) is a Collection Store, that is a "system that
processes and/or retains collected SIGINT data items, and that permits access to those
performing collection functions and limits access of those performing intelligence analysis".
LONGHAUL maintains internal databases that contain "technical data", and
LONGHAUL also exchanges "technical data" with other CES databases and with
CES HPC resources that perform attacks. This "technical data" includes recovered

2of15

LONG HAUL - WikiInfo

keys, information about what processing is appropriate, data needed for 
attacks, as well as information retained to enable future attacks. LONGHAUL does
not store cipher data or ever have access to data. If the "technical data" passed to
Attack Service components or CES databases contains information from the collected stream (as
opposed to information about the collected stream such as SIGAD, DTOI), then appropriate
Critical Identifying Information (CII) will be passed also. From a compliance perspective this is
the system being "certi?ed".

Field deployed collection systems and CA Servers (also known as Extended
LONGHAUL) are shown on the left. A CA Server is the ?eld CES component that runs CA
Services. The terms CA Server or CA Services are used depending on the context
(hardware/software). For information on CA Server deployments see the wiki pages
CA Servers and for information on CA Server
architecture see Server. The CA Server stores cipher data, and it based
upon a key returned by LONGHAUL.

LONGHAUL is a High Availability system using hardware at two geographically
distributed locations to also provide a COOP capability. LONGHAUL uses the Application
Messaging Framework AMF with the ISLANDTRANSPORT transport and
ISLANDHIDEAWAY (IH) integrity and privacy capabilities to send data between collection
systems and LONGHAUL. The requestor of CA Services (the ?eld deployed CA Server) never
knows (or needs to know) which hardware is used to process its requests. LONGHAUL and the
AMF manage the physical routing and failover behavior of the system.

LONGHAUL has a Service-Oriented, Java-Based Enterprise Architecture. It includes
multiple coordinated software development efforts. Each Attack Orchestrator is a major
development effort, as are the Management and Analysis and Security and Policy
components. LONGHAUL also has a hardware acquisition component, and manages the
interfaces and integration activities with (collection), and the High
Performance Computing (HPC) activities of 5. The LONGHAUL team is responsible for all
phases of development, starting with requirements, thorough design, technology selection,
development, integration, system test, and deployment. The team is also responsible for the
system engineering and hardware design and acquisition to support a two-site, high-availability
system.

In July 2010, T1, T5 and CES signed an SLA for "the provisioning and support of
(CA) Services within the TURBULENCE Passive Collection Suite (TU 

Attack Orchestration

POISONNUT

POISONNUT is a Child LONGHAUL
Project that enables Data Network Cipher (DNC) Recovery. Initial Customer Capability was
released on September 30, 2009. (DNC) was determined Jan. 2011.

SCARLETFEVER
SCARLETFEVER is a Child

LONGHAUL Project that enables Data Network Session Cipher (DNSC) Recovery. Initial
Customer Capability was achieved in December 201 0.

(U) Management and Analysis

(U) For this very high level view our diagram shows Management and Analysis as one block.
This block contains many components and further details can be found on the Software
Architecture page.

(U) Additionally, LONGHAUL has begun to create a set of web applications for Management

30f15

LONG HAUL - WikiInfo

(Operations and Mission) and Mission Analysis which can be found here: Web Applications List


(U) Security and Policy

SPAM is our Security, Policy, and Adjudication Module which will be used to apply
rules for sanitizing, ?ltering, and determining if a response should be sent to a particular client.

(U) Common

All child projects share LONGHAUL COMMON components or services. This is not
shown as a separate block on the diagram as all the components use COMMON.

(U) Interfaces (ICD)

(U) All Interfaces are described on the ICD wiki page. These include both the external interfaces
(how a CA Server communicates with LONGHAUL) as well as the interfaces LONGHAUL uses
with other CES systems.

(U) Design
(U) Architecture

Software and Hardware architecture discussions are available on the LONGHAUL
Architecture page.

(U) High Availability

LONGHAUL is a high availability system that makes use of Continuity of Operations
(COOP) to meet availability requirements. The system is designed from both hardware and
software perspectives to provide high availability, ensuring that key recovery services are always
available. The two site deployment with equal processing capacity will meet the COOP
requirement for the system. Each system is designed with redundant hardware and processes so
that the system can survive any single component (hardware or software) failure. During normal
operation, both systems will be operational and share the processing load. In the event of a single
site failure, the second site will, within seconds, assume total processing responsibility, but at
reduced capacity. The requestor of CA Services (the ?eld deployed CA Server) never knows (or
needs to know) which hardware is used to process its requests. CA Servers send data to
LONGHAUL and receive responses from LONGHAUL using the AMF. LONGHAUL and the AMF
manage the physical routing and failover behavior of the system.

For more detailed information, see Availability Analysis.
(U) JMS Messaging

The use of a high capacity, low latency JMS messaging fabric is critical to the success
of the LONGHAUL mission. LONGHAUL has worked closely with the Application Messaging
Framework (AMF) team to design a fabric to support the LONGHAUL requirements.

(U) See AMF LONGHAUL Teaming for more detailed information.

The collection site clients (CA Servers) will publish messages into the fabric with no
knowledge of where the processing actually occurs. The fabric should support both active/active
and active/passive processing modes. In active/active mode multiple sites would consume the
same message, and manage the client response strategy. In active/passive, one site would
consume a message, but in a failure mode, an alternate site would seamlessly pick up message

4of15

LONG HAUL - Wikilnfo

consumption.
(U) Deployment
(U) Hardware

LON GHAUL is composed of almost identical hardware at two geographically
distributed sites - the Tordella Supercomputer Building (TS CB) at Fort Meade and Oak Ridge
Data Center (ORDC) in Oak Ridge, Tennessee. The initial hardware con?gurations for TS CB and
ORDC arrived in November 2009 and May 2010 respectively. The ?nal con?gurations arrived in
Jan 201 1 at both sites. A system, termed IIHadoop ClusterII has also been purchased to produce
analytics and store metrics for LON GHAUL. The Hadoop Cluster will reside at ORDC and is
scheduled to be delivered in April 201 1. CAVIUM is being considered for CA Server.

(U) For more detailed information, see Hardware Description and Schedule.

(U) Software Releases

LONGHAUL 3.4.0 was released on February 27, 2013. The release consists of:

I - Full Release. Built on 12 February 2013.
I Added Capabilities
I HEROICSAN improvements and initial metrics
I Bug ?xes and minor enhancements

I Included tracker artifacts v3.4.1 (r
- IrIcluded tracker?artifacts v3.4.0 (r

I POISONNUT 3.4.1 - Full Release. Built on 12 February 2013.
I Added Capabilities

I Bug ?xes and minor enhancements

I Included tracker artifacts v3.4.1

I Included tracker artifacts v3.4.0 

I - Full Release. Built on 12 February 2013.
I Added Capabilities
I Fix PLATINUMRIN timeouts for GALLANTWAVE
I Increased capacity
I Bug ?xes and minor enhancements

I Included tracker artifacts v3.4.1 

  
 

 
 

I Included tracker artifacts v3.4.0 

I - Full Release. Built on 12 February 2013.
I Added Capabilities
I Bug ?xes and minor enhancements

I Included tracker artifacts v3.4.1

I Included tracker artifacts v3.4.0 

5of15

LONG HAUL - Wikilnfo

I - Full Release. Built on 12 February 2013.
I Added Capabilities
I Bug ?xes and minor enhancements
I Included tracker artifacts v3.4.0 

 
 
 
 
  
 
 
 
 

I Included tracker artifacts v3.4.0

I - Full Release. Built on 12 February 2013.
I Added Capabilities
I Bug ?xes and minor enhancements
I Included tracker artifacts v3.4.0 

I Inc trac er arti acts v3.4.0

For more detailed information, see LON GHAUL Releases.

(U) Development
(U) Software/ Schedules

(U) Four major releases are planned - 2009, 2010, 201 1, 201 2 - with minor releases in between as
needed.

Release 1.0 - September 30, 2009 - Initial Customer Capability
Release 2.1 - December 30, 2010 - Initial Operational Capability
Release 2.2.0 - July 2011 - DNSC Scaling

Release 2.3.0 - October 26, 2011 - Initial COOP Capability
Release 2.4.0 - January 11, 2012 - COOP and Scaling Capability

Release 2.5.0 - Febuary 29, 2012 - CHAOTICSTORMTROOPER and JEDIMINDTRICK
Webapps

Release 2.6.x - Mar. 31, 2012 - Availability Improvements and Cross Agency Pairing
Prototype

Release 2.7.x - Apr. 30, 201 2 - Availability and DN SC Performance Improvements
Release 2.8.x - May. 31, 2012 - FOC Release

Release 2.9.x - June 30, 2012 - TBD

Release 3.0.x - July 31, 2012 - TBD

Release 3.1.x - Aug. 31, 2012 - TBD

60f15

LONG HAUL - Wikilnfo

Release 3.2.x - Sept. 30, 2012 - TBD

Planned caiabiliti details can be found here 

Each LONGHAUL child project had its own schedule. Projects used to be planned
quarterly "Phases" with "Milestones".

(U) Development Principles, Processes, and Standards

LONGHAUL strives to use best practices in all its development
activities, and is continually looking for ways to improve. We continue to
re?ne our processes and want to share with and learn from other projects
as well as the NSA Way. Please explore our wiki and "take" what you need.
Conversely, if you have something that works for you, please contact us.
POISONNUT was the ?rst LONGHAUL child project, and the processes
were initially developed then, but now all the child projects are using them.
LONGHAUL Principles is a description of our development principles, and

 

Aug 2010 Overview is a summary brief of the project, process and tools 
we are using. LONGHAUL
Principles

LONGHAUL Processes
Detailed information for each LONGHAUL process is available below.
(U) Requirements

Requirements Development - we use DOORS for maintaining all
our requirements.

(U) Coding Standards/Reviews

Coding Standards - Project Coding Standards 

Code Reviews Code Review Process and Code
Review Checklist

(U) Lessons Learned

Lessons Learned Changes made as a result of development
experience

(U) Con?guration Management (and Metrics)

Con?guration Management - Con?guration Management, Change
Management and Metrics

(U) Testing
Test Methodologies Testing Description

Unit Testing Unit Test Guidelines I 1
Integration Testing  Testing with ISLANDTRANSPORT

System Testing - - System Test plans and schedules.

7of15

LONG HAUL - Wikilnfo

(U) Working with NSA Way

The LONGHAUL Project is an enthusiastic participant in the NSA Way
. Because the LONGHAUL team is responsible for all phases of

development, starting with requirements, through design, technology selection, development,
integration, system test, and deployment, it uses a modi?ed NSA Way Gate structure.

(U) Development and Management Tools

LONGHAUL relies on a variety of tools to support development and management tasks. The tools
listed below have been assessed and found to be valuable

- Project Management 
including a bug and feature tracker 
(restricted)

I Subversion Repository - available for browsing 


(restricted)

I Maven Repository - an instance of Sonatype Nexus

I Continuous Builds - an instance of Hudson 


I CORALREEF - a test instance is running speci?call for us on scubadiver2
or  
.

(U) Technology

I (U) Integrating Java with 
I (U) JMS Performance Testing
I (U) 0MQ Messaging

I (U) HBase Performance Testing
I (U) Scala Research

(U) In-Memory Distributed Data Analysis of Alternatives
(AOA)

I (U) The project is looking into several technologies for in-memory data caches with
replication.

I (U) For more information, view the Distributed Data AOA
(U) BigData and Metrics Techniques

I (TS) LONGHAUL MapReduce
I (TS) Hadoop Metrics Implementation

(U) TE6 Security, Compliance and Policy
Enforcement

I LONGHAUL's position in the processing chain necessitates that it be prepared to
deal with a whole host of security, policy and compliance enforcement issues, such as
ensuring that the system is only accessed by authorized individuals, ensuring that the
processing meets all legal requirements, resolving classi?cations from multiple sources,

80f15

LONG HAUL - Wikilnfo

ensuring that the recovered are only distributed to those entities that are
authorized to receive them, ensuring that clients don't exceed some policy-de?ned limit on
amount of work requested, and a whole host of other issues. This page seeks to capture the
important security, compliance, and policy related scenarios LONGHAUL will address and
document the design of their solutions.

I For details, see LONGHAUL Security, Compliance and Policy

(U) TS Certi?cation 8: Accreditation

I This link contains information pertaining to LONGHAUL SSPs (System Security
Plans)- LONGHAUL Certi?cation Accreditation
I LONGHAUL IAVA Patch Rollout Scheme

(U) Operations

LONGHAUL has been processing DNC data since Oct. 2009, and was declared IOC for
DNC in Dec. 201 0. Also, in Dec. 2010 an ICC (Initial Customer Capability) for DNSC was
deployed. 24/7 System monitoring has been in place since Dec. 2010.

- Operations Manager 


- responsible for the operations of LONGHAUL.

I IMPORTANT: Use the gDocUpdate Website 

for the proper UNCLASSIFIED terms when talking over the

black line.

I (U) - For general contact information.

- an the steps that
need to be taken to ensure continued security when a person leaves the project.

(U) Tier 1 Support

(U) GECC - provides Tier 1 First Response/Help Desk support. The GECC attempt to resolve
unexpected operational issues using well-de?ned procedures. If resolved by the GECC, then the
details of the resolution are recorded and no further action is required. If the incident cannot be
resolved using the remote capabilities at the Operations Center's disposal or within the
pre-determined time threshold, the incident is escalated to Tier 2 for resolution.

I LONGHAUL Special Instructions - For COALCAR Incidents this SOP directs the
GECC to use to restart failing processes on COALCAR.

I STOCKCAR Special Instructions - For STOCKCAR Incidents this SOP directs the
GECC to use to restart failing processes on STOCKCAR.

- LONGHAUL System Support  For
LONGHAUL Incidents that require SA support for rebooting machines, etc. this URL directs
the GECC to use the T3332 Infrastructure Operations page.

(U) Tier 2 Support

Tier 2 Support is provided by Maintenance/Operations Support (LONGHAUL team).
Maintenance/Operations Support provides the day-to?day administration and support of
production systems in accordance with documented, deployed con?gurations. Doing so usually
requires speci?c knowledge about the associated servers, applications and how they interact.
With respect to applications, this is referred to as "applications administration", as opposed to
"systems administrationII which is performed at the server hardware and operation systems (OS)
level. Tier 2 also serves as the escalation point for problems not resolved at the Tier 1 level.
Problems related to the internal workings of the software or are integration-related issues are
escalated to the appropriate Tier 3 organization for resolution. Use the "Tier 2 Support" link

9of15

LONG HAUL - Wikilnfo

above for more information.

Troubleshooting Resources

I (U) LON GHAUL_Take_Home_Support_SOP - - Contains troubleshooting instructions
LON GHAUL Tier 2 support staff can take home.

I Troubleshootin Hel for Tier 2 Personnel 
- Page contains links to support pages for the various

LONGHAUL components and possible solutions to previously seen issues.

- an Useful Support Links - A directory
of useful support links. Contains troubleshooting instructions LON GHAUL Tier 2 support
staff can take home.

- (U) Switching Operations -
Page contains the procedures to take when switching operations to alternate site

I LON GHAUL After Hours Beachhead
- Location of after hours support
I (U) Creating a CES Help Ticket - Process

for creating a CES help ticket for LON GHAUL issues.

- tut reporting Procedures _t - 

for reporting on Tier 2 issues.

Outage Process

I (U) For unexpected/emergency outages.-

I Send messa to LH customers see outa email list
Be sure to include how the
take to restore the system.

I If system remains unavailable 1 hour after troubleshooting began, switch operations to

the alternate site (see switching operations


I If system continues to be unavailable after 90 minutes, inform T532 management. Be
sure to include how the system was affected and an estimate of how long it will take to
restore the system.

I If system continues to be unavailable after 2 hours, inform T53 management. Be sure to
include how the system was affected and an estimate of how long it will take to restore
the system.

I (U) For scheduled outaies, iollow the normal outaie procedure 

Contacting the GECC

- The GECC director
I The Turbulence desk where LON GHAUL support personnel are
located.

I T3332 Infrastructure Operations 

(for reboots of system after-hours)

(U) Tier 3 Support

Tier 3 support is provided by Development Support (LONGHAUL team).
Development Support resolves issues escalated from Tier 2 related to the internal workings of the
software requires "crackng open the code") or OTS integration. These are break/?x
activities, which are outside of typical development, and implementation activities (such as
resource planning, project management, architecture, s/w development, initial implementation
/integration/testing, etc.). Tier 3 support consists of:

10 of 15

LONG HAUL - Wikilnfo

I (U) Release Procedures - managing maintenance releases
I (U) Outage Procedures - Managing and Scheduling Outages using

(U) Site Deployments

(ti Site Deployments - contains
information about upcoming site ep oyments 0 CA Servers.

(U) Transition

Transitioning Life Cycle Support of LON GHAUL is contingent upon successful
completion of DC in September 201 1. The system will transition to the following organizations:

- arc integration and Protection ties 

I Exploitation Solutions Of?ce (ESO 
I Of?ce of Target Pursuit (OTP 
Planning for this transition began in April 201 0 and is ongoing.

For more detailed information, see Transition.

Team Members

Government Team 

Name El SID Function Af?liation Work Black 

Phone IE IE
Project
Lead T5323 
Operatms T5323 
Manager
?m
Assurance
Testtead T5323 _El
C2DP
 ?m

 

11 of 15

LONG HAUL - Wikilnfo

Contractor Team 
Function Af?liation Work Black JSignout

Name SID

Phone El El
Sotera 
it
Sotera
Sotera
Sotera
Sotera 
Sotera 
Sotera 
Sotera 
Sotera 
Sotera
Sotera

 

12 of 15

LONG HAUL - Wikilnfo

Developer Sotera In

Developer Sotera In
In

Developer Sotera

Developer Sotera

 

MIDRIFT Team Members
Function Af?liation Work Black JSignout

Name El SID Phone IEI IEI
BranCh Govt In
Manager
Deputy
Branch Govt In
Manager
Lead Govt at; 

Developer

Developer Govt

 

13 of 15

LONG HAUL - Wikilnfo

Related Team Members

Work
Function Af?liation Black JSignout
Name IE SID Phone
IEI
McLendon In
Program 
covt i]
ProgramB DigiFlight 



 

Other Useful Numbers
Name SID Function Af?liation Work Black Work

comment

 
  

El Phone El Secure
T332
Global 24/7
GECC Enterprise Enterprise
Command Monitoring
Center

(U) See also

REL) The LON HAUL team works with the following organizations:

Digital Network Applications (831322)
Attack Services (831241)

Requirements and Thread Mana ement (S313)
CA Databases (T532
Mission Capabilities (T1
I High Performance Computing Technology (T5
.T5)

  
 
 
 

to develop, deploy and test all aspects of an end-to?end processing system. Team members are
located in the OPS2A, NBP322, and NBP140.

I - LONGHAUL - C2DP Tour Description

I Computer Network Operations Development Program (C2DP)
I LONGHAUL Glossary
I LON GHAUL Frequently Asked Questions

  

I Proposed LONGHAUL 2 Coverterms

(U) External links

I (U) The L03 Coverterm page ("go coverterm
I (U) The Query a Coverterm 

  
  

14 of 15

LONG HAUL - Wikilnfo

/coverterms.startingpage) form

Retrieved from 
Categories: Coverterms LONGHAUL DNC DNSC

Derived From: SI Classification Guide. 02?01. Dated: 20060711
and 1?52. Dated: 20070108
Declassify On: 20320108

 

TOP SECRETHSIHREL TO USA, FVEY

15 of 15

