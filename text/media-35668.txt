Malware from the Five Eyes

Introduction

The Five Eyes commonly share tools and techniques, and in some occasions also collectively develop new
ones, such as the WARRIORPRIDE malware framework.

WARRIORPRIDE, as all the malware programs we discovered in Five Eyes' arsenal, is very flexible and
versatile. Among the many interception modules WARRIORPRIDE is provided with, the technical research
team has obtained a copy of QWERTY - WARRIORPRIDE's component designed to invisibly record all key
strokes from an infected Windows computer - from the Snowden Archive.

Der Spiegel is now releasing QWERTY to the public in order to foster further research and investigations. Der
Spiegel believes that the release of the malware, which appears to be several years old and likely replaced by
more recent variations, will not affect any ongoing operation.

Technical Preview

QWERTY is a keylogger, a plugin for the WARRIORPRIDE malware framework, that is designed to intercept all
keyboard keys pressed by the victim and record them for later inspection.

Its structure is really simple. It's made of a core component called a driver that interfaces directly
with Windows' keyboard manager, and a library which interacts with the driver to retrieve the keys
pressed by the user and keep track of them in a file.

QWERTY is composed of the following binary files:

- 20120.dll
- 20121 .dll
- 20123.sys

Each one of these components is provided with a structured XML document that defines all available
commands as well as dependencies.

We learned from Snowden documents that WARRIORPRIDE is the implementation of a CNE library called
Wzowski. In some of the XML documents from QWERTY we find it referenced as a dependency WzowskiLib
v2.1 along with a more generic v2.10.

Additionally, we can find hardcoded in one of the binaries the following string:



This strongly confirms the connection to WARRIORPRIDE and possibly suggests a relation to the Defense
Signals Directorate (DSD), now just known as Australian Signals Directorate (ASD), one of the Five Eyes.

File

The malware samples are contained in a password-protected zip archive (password is ?infected") attached here
encoded in base64.

To avoid problems with copy and pasting that occur with some PDF readers, the following command line can
be used on a Linux system to easily extract the zip file from this PDF:

pdftotext filename.pdf -lgrep -v greplgrep -A 1000ltr -d '\014'lsed -e -d malware.zip

The resulting zip file should have the sha1sum 










































4 5 

















9C Opol 









0 eHhUAz i 0VHV4 6AMAAH2 LY I 



















5 qu5 
4VAM4 


























L5D2 7GDQ2HV8 3 




























































2 





















5xqt88+IBoMi9E li  





























































































































































t9KZij 
























































































































































































2 9 





IZ 8 































































































































































































































