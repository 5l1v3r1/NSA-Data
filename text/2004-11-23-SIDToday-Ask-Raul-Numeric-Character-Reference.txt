<p data-reactid=".ti.1.0.0.1.0.1.$0.0" class="SidTodayFilesDetailViewer-pages-page-paragraph">DYNAMIC PAGE -- HIGHEST POSSIBLE CLASSIFICATION IS<br>TOP SECRET // SI / TK // REL TO USA AUS CAN GBR NZL<br><br>(U) Ask Raul: Numeric Character Reference<br>FROM: 'Raul', a DNI Analyst<br>Unknown<br>Run Date: 11/23/2004<br><br>(S) Hey, Raul, <br>I got this crazy numeric stuff the other day. Here's what it looks like: <br>Doh! <br>Is this some sort of encryption? <br>Tracy<br>Dear Tracy, <br>(U) Believe it or not, that's just text. Some folks refer to it as HTML Escape, or HTML special<br>characters, HTML Unicode or if you want to go by the RFC, Numeric Character Reference (NCR).<br>Here's how it works:<br>Format: <br>&amp;# Code ; for decimal (base 10) numbers <br>&amp;#x Code ; for hexadecimal (base 16) numbers <br>Code: <br>Unicode value of the character: <br>English/Latin letter D = 68 decimal or 44 hex <br>English/Latin letter a = 97 decimal or 61 hex <br>Cyrillic letter A = 1040 decimal or 410 hex <br>Arabic letter Alef = 1575 decimal or 627 hex <br>Parenthesized Hangul Hieuh = 12813 decimal or 320D hex<br>Assembled as: <br>D or D D <br>А or А Cyrillic A Ð​ <br>㈍ or ㈍ Parenthesized Hangul Hieuh ãˆ​ <br>It is very simple, is used quite commonly and has been for many years. And it seems to be a<br>"new" thing for most NSA analysts. But it gets better!<br>(S) Most email tools are normally set by default to send a text and an html version of a mail<br>message. As a result, you can oftentimes take advantage of this little condition to select traffic<br>at the front-end, search for it on the back-end, or recover a perfectly good email from a session<br>which looks lost by simply going after the NCR format.<br>(S) As you well know, all non-7-bit material going into Lionheart gets indexed as though it were<br>7-bit. So, a perfectly good foreign text term actually gets indexed as something it is not. If you<br>are lucky, and have a target that uses a character set such as KOI-8, this bit stripping results in<br>what looks like very good translit. If you are unlucky, and your target is using something like<br>CP-1251, then that bit stripping produces a mess. For example, the Russian word for tank,<br>Ñ‚Ð°Ð½Ðº, comes out of this indexing process as ' TANK ' for KOI-8 but ' r`mj ' for CP-1251.<br><br> </p><p data-reactid=".ti.1.0.0.1.0.1.$1.0" class="SidTodayFilesDetailViewer-pages-page-paragraph">You're not going to be able to use that CP-1251 term to do anything. However, the same term<br>using NCR would look like this: танк Ñ‚Ð°Ð½Ðº . Aside from<br>being much more unique simply because the pattern contains more characters (bytes), this form<br>is not harmed by the 7-bit indexing procedure.<br>(S) If you'd like to test this out, go to an Internet terminal or even webworld and type in the<br>string above. If this is the first time you've heard of NCR and you are a linguist, you'll probably<br>be amazed at what you can find on the Internet using NCR strings. There are many things that<br>normally don't show up in your other types of queries.<br>(S) Making things even better, this NCR form is absolutely beautiful for selection and filtering or<br>searching. What's more, since this form uses nothing but 7-bit characters, it can go through<br>systems, which will destroy 8-bit traffic. This means if you know what you are doing, you can<br>'recover' a perfect email message from a session, which appears to have been totally lost. Ever<br>seen a piece of email where the entire foreign language portion was nothing but question<br>marks? Chances are that same email had an html double with it containing the NCR. Old Raul<br>used to use this magic when he was in the Office of Russia to recover "totally destroyed" email.<br>When Raul left, so did the technique. Ð–Ð°Ð»ÑŒ!<br>(U) So, Tracy, there you go. It's usually the simple little things that bite us in the rear. Oh, if<br>you want a little smile, cut and paste the text below, which includes your sample, into a text<br>editor. Save it as showme.htm and then open it in your web browser.<br>Enjoy! <br>Raul<br> <br><font size="+4"> <br>Doh! <br></font> <br><br><br>"(U//FOUO) SIDtoday articles may not be republished or reposted outside NSANet<br>without the consent of S0121 (DL sid_comms)."<br><br>DYNAMIC PAGE -- HIGHEST POSSIBLE CLASSIFICATION IS<br>TOP SECRET // SI / TK // REL TO USA AUS CAN GBR NZL<br>DERIVED FROM: NSA/CSSM 1-52, DATED 08 JAN 2007 DECLASSIFY ON: 20320108<br><br> </p>